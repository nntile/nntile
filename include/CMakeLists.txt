# @copyright (c) 2022-2023 Skolkovo Institute of Science and Technology
#                          (Skoltech). All rights reserved.
#
# NNTile is software framework for fast training of big neural networks on
# distributed-memory heterogeneous systems based on StarPU runtime system.
#
# @file include/CMakeLists.txt
# Set NNTile headers
#
# @version 1.0.0
# @author Aleksandr Mikhalev
# @author Aleksandr Katrutsa
# @author Konstantin Sozykin
# @date 2023-05-10

# Set list of headers
set(BASE_HDR
    "nntile.hh"
    "nntile/base_types.hh"
    "nntile/constants.hh"
    "nntile/config.hh"
    )

set(KERNEL_HDR
    "nntile/kernel/add_slice.hh"
    "nntile/kernel/add_slice/cpu.hh"
    "nntile/kernel/add_fiber.hh"
    "nntile/kernel/add_fiber/cpu.hh"
    "nntile/kernel/prod_slice.hh"
    "nntile/kernel/prod_slice/cpu.hh"
    "nntile/kernel/prod_fiber.hh"
    "nntile/kernel/prod_fiber/cpu.hh"
    "nntile/kernel/dgelu.hh"
    "nntile/kernel/dgelu/cpu.hh"
    "nntile/kernel/dgelutanh.hh"
    "nntile/kernel/dgelutanh/cpu.hh"
    "nntile/kernel/drelu.hh"
    "nntile/kernel/drelu/cpu.hh"
    "nntile/kernel/gelu.hh"
    "nntile/kernel/gelu/cpu.hh"
    "nntile/kernel/gelutanh.hh"
    "nntile/kernel/gelutanh/cpu.hh"
    "nntile/kernel/hypot.hh"
    "nntile/kernel/hypot/cpu.hh"
    "nntile/kernel/normalize.hh"
    "nntile/kernel/normalize/cpu.hh"
    "nntile/kernel/prod.hh"
    "nntile/kernel/prod/cpu.hh"
    "nntile/kernel/randn.hh"
    "nntile/kernel/randn/cpu.hh"
    "nntile/kernel/relu.hh"
    "nntile/kernel/relu/cpu.hh"
    "nntile/kernel/relu_forward.hh"
    "nntile/kernel/relu_forward/cpu.hh"
    "nntile/kernel/relu_backward.hh"
    "nntile/kernel/relu_backward/cpu.hh"
    "nntile/kernel/subcopy.hh"
    "nntile/kernel/subcopy/cpu.hh"
    "nntile/kernel/sumnorm.hh"
    "nntile/kernel/sumnorm/cpu.hh"
    "nntile/kernel/fill.hh"
    "nntile/kernel/fill/cpu.hh"
    "nntile/kernel/sum_slice.hh"
    "nntile/kernel/sum_slice/cpu.hh"
    "nntile/kernel/sum_fiber.hh"
    "nntile/kernel/sum_fiber/cpu.hh"
    "nntile/kernel/norm_slice.hh"
    "nntile/kernel/norm_slice/cpu.hh"
    "nntile/kernel/pow.hh"
    "nntile/kernel/pow/cpu.hh"
    "nntile/kernel/maxsumexp.hh"
    "nntile/kernel/maxsumexp/cpu.hh"
    "nntile/kernel/softmax.hh"
    "nntile/kernel/softmax/cpu.hh"
    "nntile/kernel/sqrt.hh"
    "nntile/kernel/sqrt/cpu.hh"
    "nntile/kernel/maximum.hh"
    "nntile/kernel/maximum/cpu.hh"
    "nntile/kernel/addcdiv.hh"
    "nntile/kernel/addcdiv/cpu.hh"
    "nntile/kernel/sumprod_slice.hh"
    "nntile/kernel/sumprod_slice/cpu.hh"
    "nntile/kernel/sumprod_fiber.hh"
    "nntile/kernel/sumprod_fiber/cpu.hh"
    "nntile/kernel/logsumexp.hh"
    "nntile/kernel/logsumexp/cpu.hh"
    "nntile/kernel/total_sum_accum.hh"
    "nntile/kernel/total_sum_accum/cpu.hh"
    "nntile/kernel/subtract_indexed_column.hh"
    "nntile/kernel/subtract_indexed_column/cpu.hh"
    "nntile/kernel/gelu_backward.hh"
    "nntile/kernel/gelu_backward/cpu.hh"
    "nntile/kernel/gelutanh_backward.hh"
    "nntile/kernel/gelutanh_backward/cpu.hh"
    "nntile/kernel/embedding.hh"
    "nntile/kernel/embedding/cpu.hh"
    "nntile/kernel/embedding_backward.hh"
    "nntile/kernel/embedding_backward/cpu.hh"
    "nntile/kernel/fp32_to_fp16.hh"
    "nntile/kernel/fp16_to_fp32.hh"
    )

if(NNTILE_USE_CUDA)
    set(KERNEL_HDR
        ${KERNEL_HDR}
        "nntile/kernel/add_slice/cuda.hh"
        "nntile/kernel/prod_slice/cuda.hh"
        "nntile/kernel/dgelu/cuda.hh"
        "nntile/kernel/dgelutanh/cuda.hh"
        "nntile/kernel/drelu/cuda.hh"
        "nntile/kernel/gelu/cuda.hh"
        "nntile/kernel/gelu_backward/cuda.hh"
        "nntile/kernel/gelutanh/cuda.hh"
        "nntile/kernel/gelutanh_backward/cuda.hh"
        "nntile/kernel/normalize/cuda.hh"
        "nntile/kernel/prod/cuda.hh"
        "nntile/kernel/relu/cuda.hh"
        "nntile/kernel/relu_forward/cuda.hh"
        "nntile/kernel/relu_backward/cuda.hh"
        "nntile/kernel/sumnorm/cuda.hh"
        "nntile/kernel/fill/cuda.hh"
        "nntile/kernel/sum_slice/cuda.hh"
        "nntile/kernel/norm_slice/cuda.hh"
        "nntile/kernel/pow/cuda.hh"
        "nntile/kernel/maxsumexp/cuda.hh"
        "nntile/kernel/softmax/cuda.hh"
        "nntile/kernel/sumprod_slice/cuda.hh"
        "nntile/kernel/fp32_to_fp16/cpu.hh"
        "nntile/kernel/fp32_to_fp16/cuda.hh"
        "nntile/kernel/fp16_to_fp32/cpu.hh"
        "nntile/kernel/fp16_to_fp32/cuda.hh"
        )
endif()

set(STARPU_HDR
    "nntile/starpu/config.hh"
    "nntile/starpu/axpy.hh"
    "nntile/starpu/add_slice.hh"
    "nntile/starpu/add_fiber.hh"
    "nntile/starpu/prod_slice.hh"
    "nntile/starpu/prod_fiber.hh"
    "nntile/starpu/clear.hh"
    "nntile/starpu/copy.hh"
    "nntile/starpu/dgelu.hh"
    "nntile/starpu/dgelutanh.hh"
    "nntile/starpu/drelu.hh"
    "nntile/starpu/gemm.hh"
    "nntile/starpu/gemm_ex.hh"
    "nntile/starpu/gelu.hh"
    "nntile/starpu/gelutanh.hh"
    "nntile/starpu/hypot.hh"
    "nntile/starpu/nrm2.hh"
    "nntile/starpu/normalize.hh"
    "nntile/starpu/prod.hh"
    "nntile/starpu/randn.hh"
    "nntile/starpu/relu.hh"
    "nntile/starpu/relu_forward.hh"
    "nntile/starpu/relu_backward.hh"
    "nntile/starpu/subcopy.hh"
    "nntile/starpu/sumnorm.hh"
    "nntile/starpu/fill.hh"
    "nntile/starpu/sum_slice.hh"
    "nntile/starpu/sum_fiber.hh"
    "nntile/starpu/norm_slice.hh"
    "nntile/starpu/pow.hh"
    "nntile/starpu/maxsumexp.hh"
    "nntile/starpu/softmax.hh"
    "nntile/starpu/sqrt.hh"
    "nntile/starpu/maximum.hh"
    "nntile/starpu/addcdiv.hh"
    "nntile/starpu/sumprod_slice.hh"
    "nntile/starpu/sumprod_fiber.hh"
    "nntile/starpu/logsumexp.hh"
    "nntile/starpu/total_sum_accum.hh"
    "nntile/starpu/subtract_indexed_column.hh"
    "nntile/starpu/scal.hh"
    "nntile/starpu/gelu_backward.hh"
    "nntile/starpu/gelutanh_backward.hh"
    "nntile/starpu/embedding.hh"
    "nntile/starpu/embedding_backward.hh"
    "nntile/starpu/fp32_to_fp16.hh"
    "nntile/starpu/fp16_to_fp32.hh"
    )

set(TILE_HDR
    "nntile/tile.hh"
    "nntile/tile/traits.hh"
    "nntile/tile/tile.hh"
    "nntile/tile/axpy.hh"
    "nntile/tile/add_slice.hh"
    "nntile/tile/add_fiber.hh"
    "nntile/tile/prod_slice.hh"
    "nntile/tile/prod_fiber.hh"
    "nntile/tile/clear.hh"
    "nntile/tile/copy.hh"
    "nntile/tile/copy_intersection.hh"
    "nntile/tile/dgelu.hh"
    "nntile/tile/dgelutanh.hh"
    "nntile/tile/drelu.hh"
    "nntile/tile/gemm.hh"
    "nntile/tile/gemm_ex.hh"
    "nntile/tile/gelu.hh"
    "nntile/tile/gelutanh.hh"
    "nntile/tile/nrm2.hh"
    "nntile/tile/normalize.hh"
    "nntile/tile/prod.hh"
    "nntile/tile/randn.hh"
    "nntile/tile/relu.hh"
    "nntile/tile/relu_forward.hh"
    "nntile/tile/relu_backward.hh"
    "nntile/tile/sumnorm.hh"
    "nntile/tile/fill.hh"
    "nntile/tile/sum_slice.hh"
    "nntile/tile/sum_fiber.hh"
    "nntile/tile/norm_slice.hh"
    "nntile/tile/pow.hh"
    "nntile/tile/maxsumexp.hh"
    "nntile/tile/softmax.hh"
    "nntile/tile/sqrt.hh"
    "nntile/tile/maximum.hh"
    "nntile/tile/addcdiv.hh"
    "nntile/tile/sumprod_slice.hh"
    "nntile/tile/sumprod_fiber.hh"
    "nntile/tile/logsumexp.hh"
    "nntile/tile/total_sum_accum.hh"
    "nntile/tile/subtract_indexed_column.hh"
    "nntile/tile/scal.hh"
    "nntile/tile/gelu_backward.hh"
    "nntile/tile/gelutanh_backward.hh"
    "nntile/tile/fp32_to_fp16.hh"
    "nntile/tile/fp16_to_fp32.hh"
    )

set(TENSOR_HDR
    "nntile/tensor.hh"
    "nntile/tensor/traits.hh"
    "nntile/tensor/distributions.hh"
    "nntile/tensor/tensor.hh"
    "nntile/tensor/axpy.hh"
    "nntile/tensor/add_slice.hh"
    "nntile/tensor/add_fiber.hh"
    "nntile/tensor/prod_slice.hh"
    "nntile/tensor/prod_fiber.hh"
    "nntile/tensor/clear.hh"
    "nntile/tensor/copy.hh"
    "nntile/tensor/copy_intersection.hh"
    "nntile/tensor/dgelu.hh"
    "nntile/tensor/dgelutanh.hh"
    "nntile/tensor/drelu.hh"
    "nntile/tensor/gather.hh"
    "nntile/tensor/gemm.hh"
    "nntile/tensor/gemm_ex.hh"
    "nntile/tensor/gelu.hh"
    "nntile/tensor/gelutanh.hh"
    "nntile/tensor/nrm2.hh"
    "nntile/tensor/normalize.hh"
    "nntile/tensor/prod.hh"
    "nntile/tensor/randn.hh"
    "nntile/tensor/relu.hh"
    "nntile/tensor/relu_forward.hh"
    "nntile/tensor/relu_backward.hh"
    "nntile/tensor/scatter.hh"
    "nntile/tensor/sumnorm.hh"
    "nntile/tensor/fill.hh"
    "nntile/tensor/sum_slice.hh"
    "nntile/tensor/sum_fiber.hh"
    "nntile/tensor/norm_slice.hh"
    "nntile/tensor/pow.hh"
    "nntile/tensor/maxsumexp.hh"
    "nntile/tensor/softmax.hh"
    "nntile/tensor/sqrt.hh"
    "nntile/tensor/maximum.hh"
    "nntile/tensor/addcdiv.hh"
    "nntile/tensor/sumprod_slice.hh"
    "nntile/tensor/sumprod_fiber.hh"
    "nntile/tensor/logsumexp.hh"
    "nntile/tensor/total_sum_accum.hh"
    "nntile/tensor/subtract_indexed_column.hh"
    "nntile/tensor/scal.hh"
    "nntile/tensor/gelu_backward.hh"
    "nntile/tensor/gelutanh_backward.hh"
    "nntile/tensor/embedding.hh"
    "nntile/tensor/embedding_backward.hh"
    "nntile/tensor/fp32_to_fp16.hh"
    "nntile/tensor/fp16_to_fp32.hh"
    )

set(LAYER_HDR
    #"nntile/layer.hh"
    #"nntile/layer/base.hh"
    #"nntile/layer/gelu.hh"
    #"nntile/layer/gelutanh.hh"
    #"nntile/layer/linear.hh"
    #"nntile/layer/mlp.hh"
    )

set(MODEL_HDR
    #"nntile/model.hh"
    #"nntile/model/base.hh"
    #"nntile/model/deep_linear.hh"
    )

set(OPTIMIZER_HDR
    #"nntile/optimizer.hh"
    #"nntile/optimizer/base.hh"
    #"nntile/optimizer/sgd.hh"
    #"nntile/optimizer/deep_linear.hh"
    )

set(HDR ${BASE_HDR} ${KERNEL_HDR} ${STARPU_HDR} ${TILE_HDR} ${TENSOR_HDR})
    #${LAYER_HDR})# ${MODEL_HDR} ${OPTIMIZER_HDR})

target_sources(nntile PUBLIC ${HDR})

